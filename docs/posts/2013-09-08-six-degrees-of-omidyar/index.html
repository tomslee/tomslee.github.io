<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tom Slee">
<meta name="dcterms.date" content="2013-09-08">

<title>Six Degrees of Omidyar – Tom Slee</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Six Degrees of Omidyar – Tom Slee">
<meta name="twitter:description" content="Personal web site">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Tom Slee</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../essays.html"> 
<span class="menu-text">Essays</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../uncertainties.html"> 
<span class="menu-text">Uncertainties</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://tomslee.github.io/ridehail/lab/"> 
<span class="menu-text">Ridehail Lab</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Whimsley (blog archive)</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tomslee"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/whimsley"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Six Degrees of Omidyar</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">blog archive</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tom Slee </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 8, 2013</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This page has been migrated from an earlier version of this site. Links and images may be broken.</p>
</div>
</div>
<pre><code>            _Venture capital damages commons-based sharing, and one name appears time and time again..._</code></pre>
<p>[<strong>Update:</strong> a version of this post, re-edited in the light of the Omidyar/Greenwald news venture, is now at <a href="http://thenewinquiry.com/essays/charity-assets/">The New Inquiry: Charity Assets</a>.]</p>
<p>Start with an old story. Back in 2006 the world of microfinance split between “<a href="http://www.newyorker.com/archive/2006/10/30/061030fa_fact1?currentPage=all">pure do-gooders and profit-minded do-gooders</a>”, between Nobel Peace Prize winner Mohammed Yunus and eBay billionaire Pierre Omidyar. Yunus’s Grameen Bank had <a href="https://en.wikipedia.org/wiki/Grameen_Bank">pioneered</a> group-based credit for the impoverished, but had stayed away from making the Bank into a public company; Omidyar wanted to turn microfinance into&nbsp;a fully commercial, profit-making sector.</p>
<p>A few years later Hugh Sinclair, who spent several years working for microfinance institutions, compellingly <a href="http://www.microfinancetransparency.com/">described</a> his disillusionment and anger at the way the industry was going in <em>Confessions of a Microfinance Heretic</em>: as money flooded into the microfinance institutions, they became like the loan sharks they replaced.&nbsp;At the centre of the book is the <em>Lift Above Poverty Organization</em> (LAPO), a Nigerian microfinance institution (MFI). It charged deceptive and high interest rates, it was audited by the brother of the CEO, and it siphoned money into many already-wealthy pockets.&nbsp;As microfinance grew in scale it spawned a web of interacting operations: microfinance funds invest in microfinance institutions which are rated by microfinance rating agencies, and which make loans through other partners. Principal-agent problems become pervasive and, without a regulatory framework, there were incentives everywhere that not only enabled corruption but, Sinclair argues, pushed participants to keep a lid on stories of corruption—to try to fix them quietly rather than to risk the reputation of the broader industry. Taking a charity and turning it into a bank is, Sinclair says, a great way to build assets and then capitalize on them.</p>
<p>Beyond generally promoting the market-driven approach to microfinance, Omidyar Network was a big donor to Unitus, a microfinance fund embroiled in a <a href="http://www.nytimes.com/2010/07/30/business/30micro.html">2010 scandal</a> involving Indian MFI SKS. When SKS went public, raising $350m in its IPO, Unitus backed out of microfinance: “In charity circles, people wondered about the motives of the Unitus board members, at least four of whom had invested in SKS Microfinance themselves and thus would reap profits from the I.P.O.” More controversy followed in 2012 <a href="http://online.wsj.com/article/SB10001424052970203918304577242602296683134.html">when</a> it was revealed that over&nbsp;200 poor, debt-ridden residents of Andhra Pradesh killed themselves&nbsp;in late 2010. The state blamed microfinance companies for fueling a frenzy of “overindebtedness and then pressuring borrowers so relentlessly that&nbsp;some took their own lives”.</p>
<p>Sinclair concludes that “Frankly, I think the only means to rein in these groups is to formally regulate them.” (p227) He also notes that “Impact Investing”, which is the Omidyar Network’s current emphasis, has similar problems: “I do not believe there are panaceas for poverty reduction – it is hard work and requires a number of tools used wisely and collaboratively” (p236).</p>
<p>A lesson of the story is that, as capital and social action have conflicting goals, using markets to scale up social action can destroy the very thing that made it special in the first place.</p>
<p>Microfinance operates at the border between charity and business.&nbsp;LAPO was for several years a major partner of Omidyar-funded “peer-to-peer” lender Kiva, until Kiva cut ties in&nbsp;<a href="http://www.kiva.org/partners/20#LAPOupdate">2010</a>. The episode highlighted a fact that was&nbsp;<a href="http://www.nytimes.com/2009/11/09/business/global/09kiva.html">worrying some observers</a>, including&nbsp;<a href="http://www.cgdev.org/blog/kiva-not-quite-what-it-seems">David Roodman</a>: “peer-to-peer” lending is not actually peer-to-peer, instead Kiva works with intermediary partners which in turn make loans which were&nbsp;<a href="http://blog.givewell.org/2009/12/28/celebrated-charities-that-we-dont-recommend/">not</a>, as many thought, interest-free.</p>
<ul>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</li>
</ul>
<p>Anyway, new topic. Last year I was <a href="http://reviewcanada.ca/magazine/2012/04/click-to-judge/">reviewing</a> a book on the reputation economy which included a chapter by the founders of GlobalGiving, an <a href="http://www.globalgiving.org/aboutus/media/omidyar_hewlett2.html">Omidyar-funded</a> “Internet-based service focused on making international philanthropy more efficient and high impact”. GlobalGiving set out to use technology and capital to scale up charitable giving, just as Omidyar had set out to use capital and commerce to scale up microfinance. Believing in Omidyar’s vision of “market-based efforts that catalyze economic and social change”, GlobalGiving adopted a “hybrid model” involving a parallel company (ManyFutures) that provided a technology platform to support its charitable work. But ManyFutures never made money, so the funding transfer ended up going from GlobalGiving to ManyFutures rather than the other way round, and controversy <a href="http://www.nytimes.com/2010/10/26/business/26hybrid.html?_r=0">ensued</a>. As with microfinance, the idea that capital and sharing are natural complements went wrong.</p>
<p>The idea that bringing commerce to play can scale up nonprofit efforts has become commonplace in the technology world, and the Omidyar Network is the poster child for mixing profit and sharing. It’s a “philanthropic investment firm” that supports “market-based approaches with the potential for large-scale, catalytic impact”; it’s taken a lead in “impact investing”, and in “social enterprise”. The ideas of social entrepreneurship, <a href="https://en.wikipedia.org/wiki/Benefit_corporation">Benefit Corporations</a> or the closely-related <a href="https://en.wikipedia.org/wiki/B_Corporation_(certification)">B Corporation</a> sound sunny—who <em>doesn’t</em> want to Do Well by Doing Good?—but capital has a way of eroding sharing-based initiatives. The hybrid charity and microfinance examples are two that I had come across, but it doesn’t stop there…</p>
<ul>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</li>
</ul>
<p>So a little while ago, I wrote about the tensions between capital and commons in an essay called <a href="http://thenewinquiry.com/essays/open-wide/">Open Wide</a>, at <em>The New Inquiry</em>. As part of the research for that essay I looked at what had happened to travel community <a href="https://www.couchsurfing.org/">Couchsurfing</a>, and wrote this:</p>
<blockquote class="blockquote">
<p>In his book <em>Cognitive Surplus</em>, Clay Shirky highlighted Couchsurfing, a site&nbsp;where young global travelers can arrange to visit and host each other, as a&nbsp;healthy digital commons. Couchsurfing started life as couchsurfing.org, not&nbsp;couchsurfing.com; even the code that ran the site was provided by the&nbsp;Couchsurfers themselves. But the site did have owners, and in August 2011,&nbsp;they incorporated and accepted $7.6 million in venture funding. As the&nbsp;company’s market value has grown, the Couchsurfing community has deteriorated.&nbsp;A long-time Couchsurfer laments the days of “art gatherings, bonfires, a&nbsp;weekly meet up at a bar, café gatherings, potlucks,” now lost.</p>
<p>The community’s former strength turned out to have little to do with&nbsp;technology. As a commenter at Quora writes:</p>
<p>“The old Couchsurfing thrived with a very haphazard and underfunded management&nbsp;structure precisely because local volunteers around the world believed they&nbsp;were part of a cause bigger than profit. Local collectives were highly tied to&nbsp;their local communities… The technical architecture of the new systems is&nbsp;much better, but paradoxically the ‘professional’ product development process&nbsp;fixes things that were broken on purpose. In other words, Couchsurfing evolved&nbsp;around certain quirks and inefficient processes that actually became critical&nbsp;to the health of the social trust platform.”</p>
<p>Over 5000 Couchsurfing members have joined the forum <strong>We are Against CS&nbsp;becoming a for-profit corporation</strong>.</p>
Contrast Couchsurfing with <a href="http://www.hihostels.com/">Hostelling International</a>, a venerable network of&nbsp;national youth hostelling organizations that has remained resolutely&nbsp;nonprofit. Over 100 years old, it is still going strong and “currently&nbsp;provides 35 million overnight stays a year through more than 4,000 hostels in&nbsp;over 80 countries.” Some people do support themselves through the commons of&nbsp;hostels — some work in the hosteling organizations, others are paid to run&nbsp;hostels themselves — but it’s orders of magnitude away from the sudden&nbsp;injection of millions of venture-capital dollars.
</blockquote>
<p>What I didn’t do was name the organization that funded Couchsurfing’s transition from nonprofit to profit-driven company. But you know what it is: it’s the <a href="http://www.omidyar.com/about_us/news/2012/08/22/couchsurfing-raises-15-million-series-b-led-general-catalyst-partners-inclu">Omidyar Network</a>. Again, it saw markets and profit as a way to scale up a non-market operation, and again the profit motive is driving out the non-commercial effort that is needed to sustain a trusting community. Couchsurfing will not have the longevity of Hostelling International, just as GlobalGiving will not have the longevity of Oxfam.</p>
<p>Update (October 15 2013): Couchsurfing’s CEO just resigned and 40% of the staff was layed off. See <a href="https://mechanicalbrain.wordpress.com/2013/10/11/more-bad-news-at-couchsurfing/">here</a> and the announcement <a href="http://blog.couchsurfing.com/changes-at-hq/">here</a>.</p>
<ul>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</li>
</ul>
<p>Before writing <em>Open Wide</em>, I wrote some things about Open Government, including <a href="http://crookedtimber.org/2012/06/25/seeing-like-a-geek/">Seeing Like a Geek</a> at the Crooked Timber group blog. Open Government Data is yet another area where commerce and sharing sound like they mix nicely, but where there are real problems. In short, one of the things that making data open does is to make it free. If action around open data is kept non-commercial, then it may form an alternative to profit-driven action, but if commercial use of open data becomes the predominant form then all that has happened is that one form of industry has been replaced by another, and as the new industry is technology-driven it is more likely to be an oligopoly than the industry it replaces.</p>
<p>No surprise, then, that as I was doing the research for that piece it turns out that the Omidyar Network is deeply involved in both the <a href="http://www.opengovpartnership.org/ogp-budget">Open Government Partnership</a> at the international level, in <em>Code for America</em> in the USA, and is the first major investor in the UK <a href="http://www.theodi.org/news/uk-leads-demand-open-data-odi-opens-business">Open Data Institute</a>. At Code for America, which describes itself as a <a href="http://www.codeforamerica.org">new kind of public service</a>, Omidyar has funded an Accelerator arm which invests in startups, conveniently augmenting the idea of “service” with the contradictory idea of “entrepreneurship” and blurring the boundaries between those who want to make money from government contracts and those who want to contribute to a stronger civic space. Unsurprisingly, the Open Data initiative has been <a href="http://www.gov2summit.com/gov2010/public/content/sponsors">colonized</a> by <a href="http://en.oreilly.com/gov2fall09/public/content/microsoft">major</a> companies.</p>
<ul>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</li>
</ul>
<p>And still we are not done. Here is one final case where the Omidyar Network’s vision of social enterprise leads to more enterprise, but less social. In 2012 <a href="http://www.change.org/">Change.org</a> joined Couchsurfing as a “.org” site with a for-profit motive–a misleading presentation of the organization’s mandate. Change.org changed its mandate from being a broadly progressive non-profit to a for-profit company, <a href="http://www.huffingtonpost.com/2012/10/22/changeorg-corporate-gop-campaigns-internal-documents_n_1987985.html">allowing</a> “corporate advertising, Republican Party solicitations, astroturf campaigns, anti-abortion or anti-union ads and other controversial sponsorships”. In <a href="http://www.omidyar.com/about_us/news/2013/05/21/changeorg-secures-investment-omidyar-network">May 2013</a> it took venture capital from the Omidyar Network and others in order to scale up, and the nature of the organization changed. The change in mission was described by <a href="http://inthesetimes.com/duly-noted/entry/14070/change.org_quietly_changing_course/">Lindsay Beyerstein</a> in <em>In These Times</em> and <a href="http://www.huffingtonpost.com/2012/10/22/changeorg-corporate-gop-campaigns-internal-documents_n_1987985.html">Ryan Grim</a> of The Huffington Post.</p>
<p>The Omidyar/Change.org press release uses the standard language of social entrepreneurs: blandly inspirational and content-free.</p>
<blockquote class="blockquote">
“Social enterprises can play an instrumental role in solving some of the&nbsp;world’s biggest problems,” Rattray said. “This funding will help us continue&nbsp;to expand our empowerment tools internationally while innovating on new&nbsp;products with the potential for disruptive social impact.”
</blockquote>
<p>Every challenge is a problem, rather than a conflict. Who can disagree with phrases like this?</p>
<blockquote class="blockquote">
Omidyar Network was founded on the fundamental belief that every person has&nbsp;the power to make a difference. We create opportunity for people to realize&nbsp;that power and improve the quality of their lives. When people take the&nbsp;initiative to make life better for themselves, they can share the benefits&nbsp;with their families, become more active in their communities, and be a more&nbsp;positive force in society.
</blockquote>
<p>These failures demonstrate concretely what I have been arguing more generally: that the idea of a natural synergy between business and sharing, between capital and commons—encoded in the ideas of social enterprise, in the Apache flavours of open source license, and in the variant of open content licensing favoured by Omidyar-funded organizations—is fraught with tensions and contradictions. Also, I may be wrong, but from what I can see these repeated failures have not been addressed by Omidyar Network in a public way.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>2023 – 2024, Tom Slee</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>